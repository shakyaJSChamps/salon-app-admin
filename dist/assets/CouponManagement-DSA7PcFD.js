import{r as i,j as e,P as v,Z as S,b as y,W as b,$ as w,N as g,F as I,a0 as E,a as O,I as f,E as x,a1 as T,a2 as U,a3 as B,Y as A,q as R,C as N,a4 as F}from"./index-DvAQHZBz.js";import{X as P}from"./index.es-Mzx9QTXI.js";import{R as k}from"./index.esm-CtgEoWdf.js";import{C as M}from"./CustomTitle-Ba-iC58E.js";import{C as W}from"./CommonImage-CbDTdfkx.js";import{B as V}from"./index.esm-zdE-Colu.js";import"./index.esm-DKblCDgZ.js";const $=({onEditCoupon:t,couponData:l,searchByText:m,setOption:r})=>{const[d,o]=i.useState([]);i.useEffect(()=>{o(l)},[l]);const u=a=>{b.fire({title:"Are you sure?",text:"Coupon deleted successfully",icon:"warning",width:"30%",showCancelButton:!0,confirmButtonColor:"#000000",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",customClass:"custom-swal",allowOutsideClick:!1}).then(n=>{n.isConfirmed&&p(a)})},p=async a=>{try{if(!a||!a.ID)throw new Error("Invalid coupon data");await w(a.ID),g.success("Coupon deleted successfully."),o(n=>n.filter(s=>s.ID!==a.ID))}catch(n){g.error(`Failed to delete coupon: ${n.message}`)}},c=[{name:e.jsx("strong",{children:"COUPONS"}),minWidth:"200px",cell:a=>e.jsxs("div",{className:"mt-1 mb-2 position-relative image-title",children:[a.name,e.jsx("div",{className:"d-flex  align-items-center",children:e.jsx(W,{imageUrl:a.imageUrl,alt:"Coupon Image",classes:"coupon-image"})})]})},{name:e.jsx("strong",{children:"DESCRIPTION"}),minWidth:"200px",cell:a=>e.jsx("div",{className:"coupon-description",children:a.description})},{name:e.jsx("strong",{children:"DISCOUNT"}),minWidth:"200px",cell:a=>e.jsx("div",{className:"add-coupon-discount",children:a.discountDetails})},{name:e.jsx("strong",{children:"DURATION"}),minWidth:"200px",cell:a=>e.jsxs("div",{className:"mt-4 ads-duration",children:[e.jsxs("div",{children:["Starts",e.jsx("br",{})," ",new Date(a.startDate).toLocaleDateString()]}),e.jsxs("p",{className:"expire-text",children:["Expire on ",e.jsx("br",{})," ",new Date(a.endDate).toLocaleDateString()]})]})},{name:"",cell:a=>e.jsxs("div",{children:[e.jsx(y,{className:"me-2",onClick:()=>t(a),style:{cursor:"pointer"}}),e.jsx(k,{onClick:()=>u(a),style:{cursor:"pointer"}})]})}],h={rows:{style:{minHeight:"130px"}}};return e.jsx(v,{className:"coupon-service-paper px-3 h-100",elevation:3,children:e.jsx(P,{title:e.jsx(M,{icon:e.jsx(S,{}),title:"Coupon",setOption:r,searchByText:m,options:[{text:"Name",value:"name"},{text:"Start Date",value:"startDate"},{text:"End Date",value:"endDate"}]}),columns:c,data:d,pagination:!0,highlightOnHover:!0,customStyles:h,noDataComponent:e.jsx("div",{children:"No records to display"})})})},L=({selectedCoupon:t,onCouponSaved:l,setSelectedCoupon:m})=>{const r={name:"",details:"",description:"",discountDetails:"",startDate:"",endDate:"",imageUrl:"https://example.com/summer-sale-image.jpg",createdBy:"admin@example.com",isActive:!0,isDeleted:!1},[d,o]=i.useState(r);i.useEffect(()=>{o(t?{name:t.name||"",details:t.details||"",description:t.description||"",discountDetails:t.discountDetails||"",startDate:t.startDate?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate?new Date(t.endDate).toISOString().split("T")[0]:"",imageUrl:t.imageUrl||"https://example.com/summer-sale-image.jpg",createdBy:t.createdBy||"admin@example.com",isActive:t.isActive!==void 0?t.isActive:!0,isDeleted:t.isDeleted!==void 0?t.isDeleted:!1}:r)},[t]);const u=async(c,{resetForm:h})=>{const a=s=>new Date(s).toISOString(),n={...c,startDate:a(c.startDate),endDate:a(c.endDate)};try{let s;t?s=await U(n,t.ID):s=await B(n),g.success(s.data.message),h(),l(s.data.data),m(null)}catch(s){g.error(s.message)}},p=()=>{m(null),o(r)};return e.jsxs(v,{className:"coupon-service-paper px-3 mb-1 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(S,{}),e.jsx("p",{className:"ps-1 fw-bold mb-0",children:t?"Edit Coupon":"Create New Coupon"}),t&&e.jsx(V,{onClick:p,className:"cursor-pointer ms-auto"})]}),e.jsx("hr",{className:"mt-4"}),e.jsx("div",{className:"coupon-form",children:e.jsx(I,{enableReinitialize:!0,initialValues:d,validationSchema:E,onSubmit:u,children:()=>e.jsxs(O,{children:[e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(f,{label:"Coupon Name",type:"text",name:"name"}),e.jsx(x,{name:"name",component:"div",className:"text-danger"})]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(f,{label:"Coupon Sub Name",type:"text",name:"details"}),e.jsx(x,{name:"details",component:"div",className:"text-danger"})]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("label",{className:"fw-bold",children:"Coupon Description"}),e.jsx(T,{as:"textarea",className:"form-control input",rows:"3",cols:"25",name:"description"}),e.jsx(x,{name:"description",component:"div",className:"text-danger"})]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(f,{label:"Coupon Discount",type:"text",name:"discountDetails"}),e.jsx(x,{name:"discountDetails",component:"div",className:"text-danger"})]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(f,{label:"Start Date",type:"date",name:"startDate"}),e.jsx(x,{name:"startDate",component:"div",className:"text-danger"})]}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx(f,{label:"End Date",type:"date",name:"endDate"}),e.jsx(x,{name:"endDate",component:"div",className:"text-danger"})]}),e.jsx("div",{className:"d-flex justify-content-center coupon-btn mt-1",children:e.jsx("button",{type:"submit",className:"button pt-1",children:t?"UPDATE COUPON":"ADD COUPON"})})]})})})]})},_=()=>{const[t,l]=i.useState(null),[m,r]=i.useState([]),[d,o]=i.useState(""),[u,p]=i.useState("name"),c=async(s=1)=>{let j=`?${u}=${d}`;try{const C=(await F(j)).data.data.items;r(C||[])}catch(D){g.error(D.message)}},h=s=>{o(s)};i.useEffect(()=>{c()},[d]);const a=s=>{l(s)},n=s=>{r(j=>t?j.map(D=>D.ID===s.ID?s:D):[s,...j]),l(null)};return e.jsx(A,{children:e.jsxs(R,{children:[e.jsx(N,{md:4,children:e.jsx(L,{selectedCoupon:t,onCouponSaved:n,setSelectedCoupon:l})}),e.jsx(N,{md:8,children:e.jsx($,{onEditCoupon:a,couponData:m,searchByText:h,setOption:p})})]})})};export{_ as default};
